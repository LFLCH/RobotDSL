# Project development process

## Modeling
The modeling task was handled using the Eclipse IDE for DSL developpers, that contains [XText](https://en.wikipedia.org/wiki/Xtext) a DSL framework and the [Ecore](https://en.wikipedia.org/wiki/Eclipse_Modeling_Framework#Ecore) metamodel, both easing the process in their way. 

First model

![first_model](models/first_model.svg)

Current model
![current_model](models/current_model.svg)


## Creation of a langium project

## Writting the grammar
To complete this step, we used two different approaches.

### Grammar based on the model
Firstly, we tried to use the grammar generated by our first model. For that, we used the [xtext2langium](https://github.com/TypeFox/xtext2langium) extension to try our LSP on a VSCode server. But there was an important problem concerning the expression, especially the expression priority that throws a lot of syntax errors.

#### Example of what we tried for the first attempt
```typescript
Expression:
    ArithmeticExpression | BooleanExpression;

ArithmeticExpression:
    UnaryArithmeticOperator | BinaryArithmeticOperator;

UnaryArithmeticOperator:
    ('-'ArithmeticOperand | (ArithmeticOperand ('++' | '--')) | ('++' | '--')ArithmeticOperand);

BinaryArithmeticOperator:
    ArithmeticOperand ('+' | '-' | '*' | '/' | '%' | '<' | '<=' | '>' | '>=' | '==' | '!=' | '+=' | '-=' | '*=' | '/=' | '%=') ArithmeticOperand;
```

### Grammar based on an external resource
For this second attempt, we decided to use expressions based on [Lorenzo Bettini resources](https://github.com/LorenzoBettini/packtpub-xtext-book-examples/tree/master).
This grammar, on the contrary of the first one, orders operators, boolean and arithmetic.
On top of this grammar, we can find the less priority operator, the `OR` one. Then, we can find the most priority operator at the bottom: variable, integer constant, function call and our own symbols. It is here where we placed the specific Robot actions. 

#### Example of our custom actions
```typescript
Atomic infers Expression:
    {infer RobotSpeedAdjust} 'ModifySpeed' speed=Expression 'in' unit=DistanceUnit |
    {infer RobotMovement} robotMovement=Movement distance=Expression 'in' unit=DistanceUnit |
    {infer RobotRotation} robotRotation=Rotation angle=Expression |
    {infer RobotTimeSensor} 'CurrentTime' 'in' unit=TimeUnit |
    {infer RobotDistanceSensor} 'CurrentDistance' 'in' unit=DistanceUnit
```
This try was the good one and we succeeded to write our first program. 

```java
int sum(int a, int b) {

    int c = a;
    for(int i = 0; i < b; i = i + 1){
        c = c + 1;
    }
    return c;
}

int a = 0;
int b = 3;
int d = a + b;
int c = sum(a, b);
```
After a try on the VSCode server with our LSP, we then do not obtain any syntax errors.

## Creation of a parsing tool
Visitor design pattern : how we used it and what were our choices.

## Interpreter

## Compiler

## Known isssues
Drawing (web)

## Possible improvements
Use of the visitor :
Prettier, Parser 

slider (web)



